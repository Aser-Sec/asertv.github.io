<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aser TV</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --primary-color: #e50914;
  --bg-color: #141414;
  --text-color: #fff;
  --card-bg: rgba(20,20,20,0.9);
}
* { margin:0; padding:0; box-sizing:border-box; font-family:'Roboto', sans-serif; }
body { background: var(--bg-color); color: var(--text-color); overflow-x:hidden; }

/* Intro animation */
#intro { position:fixed; top:0; left:0; width:100%; height:100%; background:#000; display:flex; align-items:center; justify-content:center; z-index:9999; }
#introText { font-size:20rem; color: var(--primary-color); opacity:0; transform:scale(0.5); transition: transform 1s ease, opacity 1s ease; }

header { position:sticky; top:0; background:#000; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; z-index:100; }
header h2 { color: var(--primary-color); font-size:1.5rem; }
header input { width:300px; padding:0.5rem 1rem; border-radius:4px; border:none; font-size:1rem; }

#hero { width:100%; height:400px; position:relative; overflow:hidden; margin-bottom:2rem; }
#hero img { width:100%; height:100%; object-fit:cover; position:absolute; top:0; left:0; opacity:0; transition:opacity 1s; }
#hero img.active { opacity:1; }

.row { margin-bottom:2rem; }
.row h3 { margin:0 0 0.5rem 1rem; }
.row-content { display:flex; overflow-x:auto; padding:0 1rem; scroll-behavior:smooth; }
.card { min-width:180px; margin-right:1rem; transition:transform 0.3s; cursor:pointer; position:relative; border-radius:8px; overflow:hidden; }
.card:hover { transform:scale(1.08); }
.card img { width:100%; display:block; }
.card-info { position:absolute; bottom:0; left:0; right:0; background:var(--card-bg); padding:0.5rem; font-size:0.85rem; display:none; }
.card:hover .card-info { display:block; }

#playerModal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); display:none; flex-direction:column; align-items:center; justify-content:center; z-index:200; }
#playerModal iframe { width:80%; height:70%; border:none; border-radius:8px; }
#closeBtn { margin-top:1rem; padding:0.5rem 1rem; background: var(--primary-color); border:none; border-radius:4px; font-size:1rem; cursor:pointer; }

#seasonsContainer, #episodesContainer { display:flex; flex-wrap:wrap; margin-top:1rem; justify-content:center; }
.season-btn, .episode-btn { background:#222; color:#fff; padding:0.5rem 1rem; margin:0.2rem; border-radius:4px; cursor:pointer; transition:0.2s; }
.season-btn.active, .episode-btn.active { background: var(--primary-color); }

#searchResults { display:none; margin-bottom:2rem; }
#searchResults .row-content { flex-wrap:wrap; }
#searchResults .card { flex:0 0 180px; margin:0.5rem; }
</style>
</head>
<body>
<div id="intro">
  <h1 id="introText">A</h1>
  <audio id="introSound" src="https://freesound.org/data/previews/457/457448_5121236-lq.mp3"></audio>
</div>
<header>
  <h2>ASER</h2>
  <input type="text" id="searchInput" placeholder="Search movies or TV shows...">
</header>
<div id="hero"></div>
<div id="searchResults" class="row">
  <h3>Search Results</h3>
  <div class="row-content" id="searchContent"></div>
</div>
<main id="mainContent"></main>
<div id="playerModal">
  <iframe id="playerFrame" allowfullscreen></iframe>
  <div id="seasonsContainer"></div>
  <div id="episodesContainer"></div>
  <button id="closeBtn">Close</button>
</div>
<script>
const TMDB_API_KEY='fbd4faee333c928fbee935e96a739b49';
const searchInput=document.getElementById('searchInput');
const searchResultsDiv=document.getElementById('searchResults');
const searchContent=document.getElementById('searchContent');
const playerModal=document.getElementById('playerModal');
const playerFrame=document.getElementById('playerFrame');
const closeBtn=document.getElementById('closeBtn');
const seasonsContainer=document.getElementById('seasonsContainer');
const episodesContainer=document.getElementById('episodesContainer');
const hero=document.getElementById('hero');
const mainContent=document.getElementById('mainContent');

// Intro Animation
window.addEventListener('load',()=>{
  const introText=document.getElementById('introText');
  const introSound=document.getElementById('introSound');
  introText.style.opacity='1';
  introText.style.transform='scale(1)';
  introSound.play();
  setTimeout(()=>{
    introText.style.transition='all 1s ease';
    introText.style.transform='scale(1.5)';
    introText.style.opacity='0';
    setTimeout(()=>{document.getElementById('intro').style.display='none'; loadHero(); loadRows();},1000);
  },1500);
});

let searchTimeout;
searchInput.addEventListener('input',()=>{
  clearTimeout(searchTimeout);
  const query=searchInput.value.trim();
  if(query.length<2){ searchResultsDiv.style.display='none'; return; }
  searchTimeout=setTimeout(async()=>{
    const data=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${TMDB_API_KEY}&language=en-US&query=${encodeURIComponent(query)}&page=1&include_adult=false`).then(r=>r.json());
    renderSearchResults(data.results);
  },400);
});

function renderSearchResults(items){
  searchContent.innerHTML='';
  if(!items||items.length===0){searchContent.innerHTML='<p>No results found.</p>'; searchResultsDiv.style.display='block'; return;}
  items.forEach(item=>{
    const title=item.title||item.name;
    const poster=item.poster_path?`https://image.tmdb.org/t/p/w500${item.poster_path}`:'';
    const card=document.createElement('div'); card.className='card';
    card.innerHTML=`<img src='${poster}' alt='${title}'><div class='card-info'><h3>${title}</h3></div>`;
    card.addEventListener('click',()=>openPlayer(item));
    searchContent.appendChild(card);
  });
  searchResultsDiv.style.display='block';
}

async function openPlayer(item){
  let embedUrl='';
  seasonsContainer.innerHTML=''; episodesContainer.innerHTML='';
  if(item.media_type==='movie'){ embedUrl=`https://vidsrc.xyz/embed/movie?tmdb=${item.id}&autoplay=1`; }
  else if(item.media_type==='tv'){
    embedUrl=`https://vidsrc.xyz/embed/tv?tmdb=${item.id}`;
    const tvData=await fetch(`https://api.themoviedb.org/3/tv/${item.id}?api_key=${TMDB_API_KEY}&language=en-US`).then(r=>r.json());
    tvData.seasons.forEach(season=>{
      if(season.season_number===0) return;
      const btn=document.createElement('div'); btn.className='season-btn'; btn.innerText=`Season ${season.season_number}`;
      btn.addEventListener('click',()=>loadEpisodes(item.id,season.season_number));
      seasonsContainer.appendChild(btn);
    });
  }
  playerFrame.src=embedUrl; playerModal.style.display='flex';
}

async function loadEpisodes(tvId,seasonNumber){
  episodesContainer.innerHTML='';
  const seasonData=await fetch(`https://api.themoviedb.org/3/tv/${tvId}/season/${seasonNumber}?api_key=${TMDB_API_KEY}&language=en-US`).then(r=>r.json());
  seasonData.episodes.forEach(ep=>{
    const btn=document.createElement('div'); btn.className='episode-btn'; btn.innerText=`${ep.episode_number}. ${ep.name}`;
    btn.addEventListener('click',()=>{ playerFrame.src=`https://vidsrc.xyz/embed/tv?tmdb=${tvId}&season=${seasonNumber}&episode=${ep.episode_number}&autoplay=1`; });
    episodesContainer.appendChild(btn);
  });
}

closeBtn.addEventListener('click',()=>{ playerFrame.src=''; playerModal.style.display='none'; seasonsContainer.innerHTML=''; episodesContainer.innerHTML=''; });

async function loadHero(){
  const trending=await fetch(`https://api.themoviedb.org/3/trending/all/week?api_key=${TMDB_API_KEY}`).then(r=>r.json());
  trending.results.slice(0,5).forEach((item,i)=>{
    const img=document.createElement('img'); img.src=item.backdrop_path?`https://image.tmdb.org/t/p/original${item.backdrop_path}`:'';
    if(i===0) img.classList.add('active'); hero.appendChild(img);
  });
  let index=0; setInterval(()=>{
    const imgs=hero.querySelectorAll('img'); imgs.forEach(img=>img.classList.remove('active')); imgs[index].classList.add('active');
    index=(index+1)%imgs.length;
  },4000);
}

async function loadRows(){
  const categories=[
    {title:'New Releases',url:`https://api.themoviedb.org/3/movie/now_playing?api_key=${TMDB_API_KEY}`},
    {title:'Top Rated Movies',url:`https://api.themoviedb.org/3/movie/top_rated?api_key=${TMDB_API_KEY}`},
    {title:'Top Rated TV Shows',url:`https://api.themoviedb.org/3/tv/top_rated?api_key=${TMDB_API_KEY}`}
  ];
  for(const category of categories){
    const data=await fetch(category.url).then(r=>r.json());
    const row=document.createElement('div'); row.className='row';
    const rowTitle=document.createElement('h3'); rowTitle.innerText=category.title;
    const rowContent=document.createElement('div'); rowContent.className='row-content';
    data.results.slice(0,15).forEach(item=>{
      const title=item.title||item.name;
      const poster=item.poster_path?`https://image.tmdb.org/t/p/w500${item.poster_path}`:'';
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`<img src='${poster}' alt='${title}'><div class='card-info'><h3>${title}</h3></div>`;
      card.addEventListener('click',()=>openPlayer(item));
      rowContent.appendChild(card);
    });
    row.appendChild(rowTitle); row.appendChild(rowContent); mainContent.appendChild(row);
  }
}
</script>
</body>
</html>